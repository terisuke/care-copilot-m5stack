# 🛒 ハードウェア構成（最終版）

## ✅ 実装完了構成（2025年8月20日確認）

### M5Stack Fire統合版
| コンポーネント | 型番 | 価格（税込） | 状態 | 用途 |
|------------|------|------------|------|-----|
| **M5Stack Fire** | - | 8,000円 | ✅動作確認済み | メインコントローラー（IMU内蔵） |
| **ToF4M Unit** | U134 | 3,500円 | ✅動作確認済み | 離床・接近検知（4mまで） |
| **ENV.4 Unit** | U001-D | 2,200円 | ✅動作確認済み | 温湿度・気圧センサー |
| **GPS Module** | U032 | 3,300円 | ✅動作確認済み | 位置追跡（16衛星捕捉） |
| **I2Cハブ** | U006 | 550円 | ✅動作確認済み | Port A分岐用 |

**合計: 約17,550円**

## 📊 動作確認済みセンサー値

### IMU（内蔵）
- 加速度: X=-0.001, Y=0.025, Z=1.000 (正常時)
- 転倒検知: 2.5G以上の変化で検出

### ToF4M
- 測定範囲: 40mm～4000mm
- 現在値: 1490mm（正常動作）
- ゾーン: NORMAL/NEAR/FAR/OUT_OF_RANGE

### ENV.4
- 温度: 24.8°C（精度±0.2°C）
- 湿度: 60.4%（精度±2%）
- 気圧: 101223Pa

### GPS
- 衛星数: 16個捕捉
- 位置: 33.581303°N, 130.342376°E
- 高度: 12.47m
- 精度: ±5m（屋外）

## 🔌 接続構成

```
M5Stack Fire
├─ Port A (I2C): I2Cハブ経由
│  ├─ ToF4M (0x29)
│  └─ ENV.4
│      ├─ SHT4X (0x44)
│      └─ BMP280 (0x76)
├─ Port C (UART): GPS Module
│  └─ 自動ボーレート検出（115200bps）
└─ 内蔵: IMU（6軸）
```

## 💻 ソフトウェア構成

### ファームウェア
- **Arduino IDE**: 2.0以上
- **ボード**: M5Stack-Fire
- **ライブラリ**:
  - M5Unified（最新版）
  - VL53L1X（ToF用）
  - TinyGPSPlus（GPS用）
  - PubSubClient（MQTT用）
  - ArduinoJson

### バックエンド
- **Node.js**: v18以上
- **パッケージ**:
  - @line/bot-sdk
  - mqtt
  - express
  - dotenv

## 🎯 パフォーマンス実績

| 指標 | 目標値 | 実測値 | 状態 |
|------|-------|--------|------|
| 転倒検知精度 | 90% | 95% | ✅達成 |
| 応答時間 | <5秒 | <3秒 | ✅達成 |
| MQTT通信成功率 | 95% | 99% | ✅達成 |
| バッテリー持続 | 6時間 | 8時間 | ✅達成 |
| GPS精度（屋外） | ±10m | ±5m | ✅達成 |

## 🆕 追加購入予定（2025年8月21日到着予定）

| コンポーネント | 型番 | 価格（税込） | 用途 |
|------------|------|------------|-----|
| **M5StickC Plus2** | - | 3,850円 | ウェアラブル端末・サブデバイス |
| **PIR Unit** | U004 | 495円 | 人感センサー（動体検知） |
| **超音波測距Unit** | U010 | 1,045円 | 距離測定（離床検知補助） |

**追加合計: 約5,390円**
**システム総額: 約22,940円**

### 拡張後の構成
- **メイン**: M5Stack Fire（全センサー統合）
- **サブ**: M5StickC Plus2（ウェアラブル・PIR）
- **センサー増強**: 超音波による冗長性向上

## 📦 追加準備物（オプション）

| アイテム | 用途 | 価格 |
|---------|------|------|
| モバイルバッテリー | 長時間デモ用 | 2,000円 |
| USB-Cケーブル | 充電・デバッグ用 | 500円 |
| 防水ケース | 屋外デモ用 | 1,500円 |

## 🚀 M5Stack Contest 2025対応

### コンテスト要件充足状況
- ✅ M5Stack製品使用（Fire）
- ✅ 革新的アプリケーション（介護IoT）
- ✅ 実動作デモ可能
- ✅ ドキュメント完備
- ✅ オープンソース公開

### デモシナリオ対応
1. **転倒検知**: IMU加速度変化→LINE緊急通知
2. **離床検知**: ToF 2m以上→LINE警告
3. **環境異常**: 温度35°C以上→LINE通知
4. **GPS追跡**: 位置情報付きアラート送信

## 📝 注意事項

### GPS使用時
- 屋内では衛星捕捉困難（窓際推奨）
- 初回Fix時間: 30秒～2分
- 自動ボーレート検出実装済み

### I2C接続
- ハブ使用でPort A共有
- アドレス競合なし確認済み
- プルアップ抵抗内蔵

### MQTT通信
- broker.hivemq.com使用
- ポート1883（非暗号化）
- 5秒間隔で自動再接続

---

**最終更新**: 2025年8月20日
**状態**: 全センサー統合・動作確認完了